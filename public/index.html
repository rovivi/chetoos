<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Unity WebGL Player | game</title>

  <style>
    #loading-bar {
      width: 960px;
      height: 600px;
      position: absolute;
      left: 50%;
      background-color: #000;
      transform: translateX(-50%);
      z-index: 1000;
      display: flex;
      /* Usa flexbox para centrar el contenido */
      justify-content: center;
      /* Centra horizontalmente */
      align-items: center;
      /* Centra verticalmente */
    }

    #loading-bar-inner {
      height: 80px;
      /* Ajusta la altura según la altura de la imagen y el texto */
      width: 100%;
      /* Ocupa todo el ancho del contenedor padre */
      transition: width 0.5s linear;
      display: flex;
      justify-content: center;
      /* Centra horizontalmente el contenido */
      align-items: center;
      /* Centra verticalmente el contenido */
      overflow: hidden;
    }

    #loading-bar-inner img {
      height: 60px;
      width: auto;
      /* Mantener la relación de aspecto */
    }


    #loading-text {
      position: absolute;
      top: 40px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 40px;
      color: aliceblue;
      z-index: 1000;
      /* Asegúrate de que sea mayor que cualquier otro elemento en la página */
    }

    #unity-canvas {
      position: relative;
      z-index: 1;
      /* Asegura que el canvas tenga un z-index menor */
    }
  </style>

</head>

<body style="text-align: center; padding: 0; border: 0; margin: 0;">
  <div id="loading-bar">
    <div id="loading-bar-inner">
      <img src="loading.webp" alt="Loading">
      <div id="loading-text">0%</div>
    </div>
  </div>
  <canvas id="unity-canvas" width="960" height="600" tabindex="-1"
    style="width: 960px; height: 600px; background: #CCCCCC"></canvas>
  <script src="Build/macv6.loader.js"></script>
  <script>


    const loadingBarInner = document.getElementById('loading-bar-inner');
    const loadingText = document.getElementById('loading-text');

    let percentage = 0; // Inicializa el porcentaje en 0
    let interval = setInterval(function () {
      if (percentage < 80) { // Incrementa hasta el 80%
        percentage += 1; // Incrementa el porcentaje en 1
        loadingBarInner.style.width = percentage*0.8 + "%";
        loadingText.textContent = percentage + "%";
      } else {
        clearInterval(interval); // Detiene el intervalo cuando alcanza el 80%
      }
    }, 20);
    // Override the console.log function to intercept "loading!" message
    let originalConsoleLog = console.log;
    console.log = function (message) {
      originalConsoleLog(message);
      if (message.includes("loading!")) {
        clearInterval(interval);
        loadingBarInner.style.width = "100%";
        loadingText.textContent = "100%";
        setTimeout(() => {
          document.getElementById('loading-bar').style.display = 'none';
          loadingText.style.display = 'none';
        }, 500); // wait 500ms then hide the bar and text
      }
    };



    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
      // Mobile device style: fill the whole browser client area with the game canvas:
      var meta = document.createElement('meta');
      meta.name = 'viewport';
      meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
      document.getElementsByTagName('head')[0].appendChild(meta);

      var canvas = document.querySelector("#unity-canvas");
      canvas.style.width = "100%";
      canvas.style.height = "100%";
      canvas.style.position = "fixed";

      document.body.style.textAlign = "left";
    }

    createUnityInstance(document.querySelector("#unity-canvas"), {
      dataUrl: "Build/macv6.data.gz",
      frameworkUrl: "Build/macv6.framework.js.gz",
      codeUrl: "Build/macv6.wasm.gz",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "DefaultCompany",
      productName: "game",
      productVersion: "4.0.2",
      // matchWebGLToCanvasSize: false, // Uncomment this to separately control WebGL canvas render size and DOM element size.
      // devicePixelRatio: 1, // Uncomment this to override low DPI rendering on high DPI displays.
    });
  </script>
</body>

</html>